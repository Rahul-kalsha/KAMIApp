import{a as W,b as Q,c as Z,d as B}from"./chunk-JD2K4Q7M.js";import{a as $,b as q}from"./chunk-AU62RWDH.js";import{a as Y}from"./chunk-E2KFHGHR.js";import"./chunk-RAI7CN5A.js";import{Aa as j,C as m,D as d,K as P,L as a,M as g,Na as z,Oa as N,Pa as D,Ra as U,T as _,X as O,Y as s,Ya as A,_a as F,a as v,b as S,cb as R,d as C,da as c,ea as l,fa as f,ga as T,ha as w,ia as b,k as y,la as h,ma as p,n as x,ra as u,ta as L,ua as V,va as M,wa as k,y as I,ya as E}from"./chunk-GJLT4NFV.js";var H=i=>({opacity:i});function J(i,e){i&1&&f(0,"app-spinner",10),i&2&&s("overlay",!0)}function K(i,e){i&1&&(c(0,"div",14),f(1,"i",15),u(2," No photos found. Try adjusting your search criteria. "),l())}function X(i,e){i&1&&(c(0,"div",27)(1,"div",28)(2,"span",29),u(3,"Loading..."),l()()())}function tt(i,e){if(i&1){let t=b();c(0,"div",18)(1,"div",19),h("click",function(){let o=m(t).$implicit,r=p(3);return d(r.onPhotoClick(o.id))})("keydown.enter",function(){let o=m(t).$implicit,r=p(3);return d(r.onPhotoClick(o.id))}),c(2,"div",20)(3,"div",21)(4,"a",22),f(5,"i",23),l()(),c(6,"h6",24),u(7),l()(),_(8,X,4,0,"div",25),c(9,"img",26),h("error",function(o){m(t);let r=p(3);return d(r.imageUtils.handleImageError(o))})("load",function(){let o=m(t).$implicit;return d(o.loading=!1)}),l()()()}if(i&2){let t=e.$implicit;a(),O("aria-label","View details of photo: "+t.title),a(3),s("href",t.url,P),a(2),s("title",t.title),a(),L(" ",t.title," "),a(),s("ngIf",t==null?null:t.loading),a(),s("src",t.thumbnailUrl,P)("alt",t.title)("ngStyle",j(8,H,t.loading?"0":"1"))}}function et(i,e){if(i&1&&(c(0,"div",16),_(1,tt,10,10,"div",17),l()),i&2){let t=p(2);a(),s("ngForOf",t.photos)}}function it(i,e){if(i&1){let t=b();c(0,"div",30)(1,"ngb-pagination",31),k("pageChange",function(o){m(t);let r=p(2);return M(r.currentPage,o)||(r.currentPage=o),d(o)}),h("pageChange",function(o){m(t);let r=p(2);return d(r.onPageChange(o))}),l()()}if(i&2){let t=p(2);a(),s("collectionSize",t.totalItems),V("page",t.currentPage),s("pageSize",t.itemsPerPage)("maxSize",5)("ellipses",!1)("boundaryLinks",!0)}}function nt(i,e){if(i&1&&(T(0),_(1,K,3,0,"div",11)(2,et,2,1,"div",12)(3,it,2,6,"div",13),w()),i&2){let t=p();a(),s("ngIf",t.photos.length===0),a(),s("ngIf",t.photos.length>0),a(),s("ngIf",t.photos.length>0)}}var G=class i{constructor(e,t,n,o){this.photosService=e;this.router=t;this.route=n;this.imageUtils=o;this.searchSubscription=this.searchSubject.pipe(y(300),x()).subscribe(r=>{this.searchTerm=r,this.currentPage=1,this.loadPhotos()})}photos=[];currentPage=1;itemsPerPage=12;loading=!1;totalItems=0;currentSort="";currentOrder="asc";searchTerm="";searchSubject=new C;searchSubscription;sortOptions=[{label:"Title (A-Z)",value:"title_asc"},{label:"Title (Z-A)",value:"title_desc"},{label:"Album ID (Asc)",value:"albumId_asc"},{label:"Album ID (Desc)",value:"albumId_desc"}];ngOnInit(){this.route.queryParams.subscribe(e=>{if(this.currentPage=Number(e.page)||1,this.searchTerm=e.search||"",e.sort){let[t,n]=e.sort.split("_");this.currentSort=t,this.currentOrder=n}this.loading||this.loadPhotos()})}updateQueryParams(){let e=v({},this.route.snapshot.queryParams);e.page=this.currentPage,this.searchTerm?.trim()?e.search=this.searchTerm:delete e.search,this.currentSort?e.sort=`${this.currentSort}_${this.currentOrder}`:delete e.sort,this.router.navigate([],{relativeTo:this.route,queryParams:e})}loadPhotos(){this.loading=!0;let e={_page:this.currentPage,_limit:this.itemsPerPage};this.searchTerm?.trim()&&(e.q=this.searchTerm),this.currentSort&&(e._sort=this.currentSort,e._order=this.currentOrder),this.updateQueryParams(),this.photosService.getPhotos(e).subscribe({next:t=>{this.photos=(t.body||[]).map(n=>S(v({},n),{loading:!0})),this.totalItems=Number(t.headers.get("x-total-count"))||0,this.loading=!1},error:t=>{console.error("Error loading photos:",t),this.loading=!1}})}onSearch(e){this.searchSubject.next(e)}onSort(e){this.currentPage=1;let[t,n]=e.split("_");this.currentSort=t,this.currentOrder=n,this.loadPhotos()}onPageChange(e){this.currentPage=e,this.loadPhotos()}onPhotoClick(e){this.router.navigate(["/photos",e])}getSortValue(){return this.currentSort?`${this.currentSort}_${this.currentOrder}`:""}ngOnDestroy(){this.searchSubscription&&this.searchSubscription.unsubscribe()}static \u0275fac=function(t){return new(t||i)(g($),g(F),g(A),g(q))};static \u0275cmp=I({type:i,selectors:[["app-photo-list"]],standalone:!0,features:[E],decls:11,vars:5,consts:[[1,"common-container"],[1,"content-wrapper"],[1,"mb-4"],["message","Loading data...",3,"overlay",4,"ngIf"],[1,"row","m-0","gap-2"],[1,"col-md-4"],["searchPlaceholder","Search Photos",3,"search","initialValue"],[1,"col-md-2"],[3,"sort","sortOptions","initialValue"],[4,"ngIf"],["message","Loading data...",3,"overlay"],["class","alert alert-info text-center mt-4","role","alert",4,"ngIf"],["class","row g-4 m-0",4,"ngIf"],["class","d-flex justify-content-center mt-4",4,"ngIf"],["role","alert",1,"alert","alert-info","text-center","mt-4"],[1,"bi","bi-info-circle","me-2"],[1,"row","g-4","m-0"],["class","col-md-6 col-lg-3",4,"ngFor","ngForOf"],[1,"col-md-6","col-lg-3"],["tabindex","0","role","button",1,"card","h-100","cursor-pointer",3,"click","keydown.enter"],[1,"card-body"],[1,"d-flex","justify-content-end"],["target","_blank",1,"text-primary",3,"href"],[1,"bi","bi-link-45deg"],[1,"card-title","text-truncate","mb-2",3,"title"],["class","position-absolute top-50 start-50 translate-middle",4,"ngIf"],[1,"img-fluid","rounded","card-img-top",3,"error","load","src","alt","ngStyle"],[1,"position-absolute","top-50","start-50","translate-middle"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"d-flex","justify-content-center","mt-4"],[3,"pageChange","collectionSize","page","pageSize","maxSize","ellipses","boundaryLinks"]],template:function(t,n){t&1&&(c(0,"div",0)(1,"div",1)(2,"h4",2),u(3,"Photo List"),l(),_(4,J,1,1,"app-spinner",3),c(5,"div",4)(6,"div",5)(7,"app-search",6),h("search",function(r){return n.onSearch(r)}),l()(),c(8,"div",7)(9,"app-sort",8),h("sort",function(r){return n.onSort(r)}),l()()(),_(10,nt,4,3,"ng-container",9),l()()),t&2&&(a(4),s("ngIf",n.loading),a(3),s("initialValue",n.searchTerm),a(2),s("sortOptions",n.sortOptions)("initialValue",n.getSortValue()),a(),s("ngIf",!n.loading))},dependencies:[U,z,N,D,B,Z,Q,W,R,Y],styles:[".card[_ngcontent-%COMP%]{transition:transform .2s}.card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 4px 15px #0000001a}.card[_ngcontent-%COMP%]   .card-img-top[_ngcontent-%COMP%]{height:100%;object-fit:cover}.card[_ngcontent-%COMP%]   .position-absolute[_ngcontent-%COMP%]{z-index:1}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:1rem}.card-title[_ngcontent-%COMP%]{font-size:.9rem;margin-bottom:.5rem}.bi-link-45deg[_ngcontent-%COMP%]{font-size:1.2rem}"]})};export{G as PhotoListComponent};
