import{a as q}from"./chunk-QNKBPRHA.js";import{a as M,b as $,c as Z,d as W}from"./chunk-JD2K4Q7M.js";import{a as Q}from"./chunk-E2KFHGHR.js";import"./chunk-RAI7CN5A.js";import{$a as U,Aa as C,C as d,D as m,L as s,M as h,Na as N,Oa as F,Ra as R,T as g,X as f,Y as a,Ya as A,_a as D,a as S,cb as z,d as x,da as c,ea as l,fa as v,ga as k,ha as T,ia as P,k as y,la as _,ma as p,n as w,ra as u,sa as b,ta as L,ua as V,va as O,wa as E,y as I,ya as j}from"./chunk-GJLT4NFV.js";var B=i=>["/profile",i];function H(i,t){i&1&&v(0,"app-spinner",10),i&2&&a("overlay",!0)}function J(i,t){i&1&&(c(0,"div",14),v(1,"i",15),u(2," No posts found. Try adjusting your search criteria. "),l())}function K(i,t){if(i&1){let e=P();c(0,"div",18)(1,"div",19),_("click",function(){let r=d(e).$implicit,o=p(3);return m(o.onPostClick(r.id))})("keydown.enter",function(){let r=d(e).$implicit,o=p(3);return m(o.onPostClick(r.id))}),c(2,"div",20)(3,"h5",21),u(4),l(),c(5,"p",22),u(6),l(),c(7,"div",23)(8,"small",24),_("click",function(r){return d(e),m(r.stopPropagation())})("keydown.enter",function(){let r=d(e).$implicit,o=p(3);return m(o.onUserClick(r.userId))}),u(9),l(),c(10,"i",25),_("click",function(r){return d(e),m(r.stopPropagation())})("keydown.enter",function(){let r=d(e).$implicit,o=p(3);return m(o.onUserClick(r.userId))}),l()()()()()}if(i&2){let e=t.$implicit;s(),f("aria-label","View details of post: "+e.title),s(3),b(e.title),s(2),b(e.body),s(2),a("routerLink",C(8,B,e.userId)),f("aria-label","View details of user: "+e.title),s(),L("User ID: ",e.userId,""),s(),a("routerLink",C(10,B,e.userId)),f("aria-label","View details of user: "+e.title)}}function X(i,t){if(i&1&&(c(0,"div",16),g(1,K,11,12,"div",17),l()),i&2){let e=p(2);s(),a("ngForOf",e.paginatedPosts)}}function Y(i,t){if(i&1){let e=P();c(0,"div",26)(1,"ngb-pagination",27),E("pageChange",function(r){d(e);let o=p(2);return O(o.currentPage,r)||(o.currentPage=r),m(r)}),_("pageChange",function(r){d(e);let o=p(2);return m(o.onPageChange(r))}),l()()}if(i&2){let e=p(2);s(),a("collectionSize",e.totalItems),V("page",e.currentPage),a("pageSize",e.itemsPerPage)("maxSize",5)("ellipses",!1)("boundaryLinks",!0)}}function ee(i,t){if(i&1&&(k(0),g(1,J,3,0,"div",11)(2,X,2,1,"div",12)(3,Y,2,6,"div",13),T()),i&2){let e=p();s(),a("ngIf",e.paginatedPosts.length===0),s(),a("ngIf",e.paginatedPosts.length>0),s(),a("ngIf",e.paginatedPosts.length>0)}}var G=class i{constructor(t,e,n){this.postsService=t;this.router=e;this.route=n;this.searchSubscription=this.searchSubject.pipe(y(800),w()).subscribe(r=>{this.searchTerm=r,this.currentPage=1,this.loadPosts()})}paginatedPosts=[];currentPage=1;itemsPerPage=10;loading=!1;totalItems=0;currentSort="";currentOrder="asc";searchTerm="";sortOptions=[{label:"Title (A-Z)",value:"title_asc"},{label:"Title (Z-A)",value:"title_desc"},{label:"User Id (A-Z)",value:"userId_asc"},{label:"User Id (Z-A)",value:"userId_desc"}];searchSubject=new x;searchSubscription;ngOnInit(){this.route.queryParams.subscribe(t=>{if(this.currentPage=Number(t.page)||1,this.searchTerm=t.search||"",t.sort){let[e,n]=t.sort.split("_");this.currentSort=e,this.currentOrder=n}this.loading||this.loadPosts()})}updateQueryParams(){let t=S({},this.route.snapshot.queryParams);t.page=this.currentPage,this.searchTerm?.trim()?t.search=this.searchTerm:delete t.search,this.currentSort&&(t.sort=`${this.currentSort}_${this.currentOrder}`),this.router.navigate([],{relativeTo:this.route,queryParams:t})}loadPosts(){this.loading=!0;let t={_page:this.currentPage,_limit:this.itemsPerPage};this.searchTerm?.trim()&&(t.q=this.searchTerm),this.currentSort&&(t._sort=this.currentSort,t._order=this.currentOrder),this.updateQueryParams(),this.postsService.getPosts(t).subscribe({next:e=>{this.paginatedPosts=e.body||[],this.totalItems=Number(e.headers.get("x-total-count"))||0,this.loading=!1},error:e=>{console.error("Error loading posts:",e),this.loading=!1}})}onSearch(t){this.searchTerm=t,this.currentPage=1,this.loadPosts()}onSort(t){this.currentPage=1;let[e,n]=t.split("_");this.currentSort=e,this.currentOrder=n,this.loadPosts()}onPageChange(t){this.currentPage=t,this.loadPosts()}onPostClick(t){this.router.navigate(["/posts",t])}onUserClick(t){this.router.navigate(["/profile",t])}ngOnDestroy(){this.searchSubscription&&this.searchSubscription.unsubscribe()}getSortValue(){return this.currentSort?this.currentSort+"_"+this.currentOrder:""}static \u0275fac=function(e){return new(e||i)(h(q),h(D),h(A))};static \u0275cmp=I({type:i,selectors:[["app-post-list"]],standalone:!0,features:[j],decls:11,vars:5,consts:[[1,"common-container"],[1,"content-wrapper"],[1,"mb-4"],["message","Loading data...",3,"overlay",4,"ngIf"],[1,"row","m-0","gap-2"],[1,"col-md-4"],["searchPlaceholder","Search Posts",3,"search","initialValue"],[1,"col-md-2"],[3,"sort","sortOptions","initialValue"],[4,"ngIf"],["message","Loading data...",3,"overlay"],["class","alert alert-info text-center mt-4","role","alert",4,"ngIf"],["class","row g-4 m-0",4,"ngIf"],["class","d-flex justify-content-center mt-4",4,"ngIf"],["role","alert",1,"alert","alert-info","text-center","mt-4"],[1,"bi","bi-info-circle","me-2"],[1,"row","g-4","m-0"],["class","col-md-6 col-lg-4",4,"ngFor","ngForOf"],[1,"col-md-6","col-lg-4"],["tabindex","0","role","button",1,"card","h-100","cursor-pointer",3,"click","keydown.enter"],[1,"card-body"],[1,"card-title","text-truncate"],[1,"card-text","text-truncate"],[1,"d-flex","justify-content-between","align-items-center"],["tabindex","0","role","button",1,"text-muted","cursor-cell",3,"click","keydown.enter","routerLink"],["tabindex","0","role","button",1,"bi","bi-person-fill","cursor-cell",3,"click","keydown.enter","routerLink"],[1,"d-flex","justify-content-center","mt-4"],[3,"pageChange","collectionSize","page","pageSize","maxSize","ellipses","boundaryLinks"]],template:function(e,n){e&1&&(c(0,"div",0)(1,"div",1)(2,"h4",2),u(3,"Post List"),l(),g(4,H,1,1,"app-spinner",3),c(5,"div",4)(6,"div",5)(7,"app-search",6),_("search",function(o){return n.onSearch(o)}),l()(),c(8,"div",7)(9,"app-sort",8),_("sort",function(o){return n.onSort(o)}),l()()(),g(10,ee,4,3,"ng-container",9),l()()),e&2&&(s(4),a("ngIf",n.loading),s(3),a("initialValue",n.searchTerm),s(2),a("sortOptions",n.sortOptions)("initialValue",n.getSortValue()),s(),a("ngIf",!n.loading))},dependencies:[R,N,F,W,Z,$,M,z,U,Q]})};export{G as PostListComponent};
