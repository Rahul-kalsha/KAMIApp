import{a as z}from"./chunk-RDOTIU5E.js";import{a as $,b as q,c as W,d as Q}from"./chunk-JD2K4Q7M.js";import{a as Z}from"./chunk-E2KFHGHR.js";import"./chunk-RAI7CN5A.js";import{$a as R,Aa as x,C as u,D as p,L as a,M as h,Na as E,Oa as D,Ra as M,T as _,X as f,Y as s,Ya as N,_a as F,a as C,cb as U,d as S,da as l,ea as c,fa as g,ga as A,ha as I,ia as v,k as y,la as d,ma as m,n as w,ra as b,sa as L,ta as T,ua as k,va as O,wa as V,y as P,ya as j}from"./chunk-GJLT4NFV.js";var B=i=>["/profile",i];function G(i,t){i&1&&g(0,"app-spinner",10),i&2&&s("overlay",!0)}function H(i,t){i&1&&(l(0,"div",14),g(1,"i",15),b(2," No albums found. Try adjusting your search criteria. "),c())}function J(i,t){if(i&1){let e=v();l(0,"a",18),d("click",function(){let n=u(e).$implicit,o=m(3);return p(o.onAlbumClick(n.id))}),l(1,"div",19)(2,"div",20)(3,"h6",21),b(4),c(),l(5,"div",22),g(6,"div",23)(7,"div",24)(8,"div",25),c(),l(9,"div",26)(10,"small",27),d("click",function(n){return u(e),p(n.stopPropagation())})("keydown.enter",function(){let n=u(e).$implicit,o=m(3);return p(o.onUserClick(n.userId))}),b(11),c(),l(12,"div"),g(13,"i",28),l(14,"i",29),d("click",function(n){return u(e),p(n.stopPropagation())})("keydown.enter",function(){let n=u(e).$implicit,o=m(3);return p(o.onUserClick(n.userId))}),c()()()()()()}if(i&2){let e=t.$implicit;a(4),L(e.title),a(6),s("routerLink",x(6,B,e.userId)),f("aria-label","View details of user: "+e.title),a(),T("User ID: ",e.userId,""),a(3),s("routerLink",x(8,B,e.userId)),f("aria-label","View details of user: "+e.title)}}function K(i,t){if(i&1&&(l(0,"div",16),_(1,J,15,10,"a",17),c()),i&2){let e=m(2);a(),s("ngForOf",e.albums)}}function X(i,t){if(i&1){let e=v();l(0,"div",30)(1,"ngb-pagination",31),V("pageChange",function(n){u(e);let o=m(2);return O(o.currentPage,n)||(o.currentPage=n),p(n)}),d("pageChange",function(n){u(e);let o=m(2);return p(o.onPageChange(n))}),c()()}if(i&2){let e=m(2);a(),s("collectionSize",e.totalItems),k("page",e.currentPage),s("pageSize",e.itemsPerPage)("maxSize",5)("ellipses",!1)("boundaryLinks",!0)}}function ee(i,t){if(i&1&&(A(0),_(1,H,3,0,"div",11)(2,K,2,1,"div",12)(3,X,2,6,"div",13),I()),i&2){let e=m();a(),s("ngIf",e.albums.length===0),a(),s("ngIf",e.albums.length>0),a(),s("ngIf",e.albums.length>0)}}var Y=class i{constructor(t,e,r){this.albumsService=t;this.router=e;this.route=r;this.searchSubscription=this.searchSubject.pipe(y(300),w()).subscribe(n=>{this.searchTerm=n,this.currentPage=1,this.loadAlbums()})}albums=[];currentPage=1;itemsPerPage=10;loading=!1;totalItems=0;currentSort="";currentOrder="asc";searchTerm="";searchSubject=new S;searchSubscription;sortOptions=[{label:"Title (A-Z)",value:"title_asc"},{label:"Title (Z-A)",value:"title_desc"},{label:"User ID (Asc)",value:"userId_asc"},{label:"User ID (Desc)",value:"userId_desc"}];ngOnInit(){this.route.queryParams.subscribe(t=>{if(this.currentPage=Number(t.page)||1,this.searchTerm=t.search||"",t.sort){let[e,r]=t.sort.split("_");this.currentSort=e,this.currentOrder=r}this.loading||this.loadAlbums()})}updateQueryParams(){let t=C({},this.route.snapshot.queryParams);t.page=this.currentPage,this.searchTerm?.trim()?t.search=this.searchTerm:delete t.search,this.currentSort?t.sort=`${this.currentSort}_${this.currentOrder}`:delete t.sort,this.router.navigate([],{relativeTo:this.route,queryParams:t})}loadAlbums(){this.loading=!0;let t={_page:this.currentPage,_limit:this.itemsPerPage};this.searchTerm?.trim()&&(t.q=this.searchTerm),this.currentSort&&(t._sort=this.currentSort,t._order=this.currentOrder),this.updateQueryParams(),this.albumsService.getAlbums(t).subscribe({next:e=>{this.albums=e.body||[],this.totalItems=Number(e.headers.get("x-total-count"))||0,this.loading=!1},error:e=>{console.error("Error loading albums:",e),this.loading=!1}})}onSearch(t){this.searchSubject.next(t)}onSort(t){this.currentPage=1;let[e,r]=t.split("_");this.currentSort=e,this.currentOrder=r,this.loadAlbums()}onPageChange(t){this.currentPage=t,this.loadAlbums()}onAlbumClick(t){this.router.navigate(["/albums",t])}onUserClick(t){this.router.navigate(["/profile",t])}getSortValue(){return this.currentSort?`${this.currentSort}_${this.currentOrder}`:""}ngOnDestroy(){this.searchSubscription&&this.searchSubscription.unsubscribe()}static \u0275fac=function(e){return new(e||i)(h(z),h(F),h(N))};static \u0275cmp=P({type:i,selectors:[["app-album-list"]],standalone:!0,features:[j],decls:11,vars:5,consts:[[1,"common-container"],[1,"content-wrapper"],[1,"mb-4"],["message","Loading data...",3,"overlay",4,"ngIf"],[1,"row","m-0","gap-2"],[1,"col-md-4"],["searchPlaceholder","Search Albums",3,"search","initialValue"],[1,"col-md-2"],[3,"sort","sortOptions","initialValue"],[4,"ngIf"],["message","Loading data...",3,"overlay"],["class","alert alert-info text-center mt-4","role","alert",4,"ngIf"],["class","row g-4 m-0",4,"ngIf"],["class","d-flex justify-content-center mt-4",4,"ngIf"],["role","alert",1,"alert","alert-info","text-center","mt-4"],[1,"bi","bi-info-circle","me-2"],[1,"row","g-4","m-0"],["href","javascript:;","class","col-md-6 col-lg-3 cursor-pointer text-decoration-none",3,"click",4,"ngFor","ngForOf"],["href","javascript:;",1,"col-md-6","col-lg-3","cursor-pointer","text-decoration-none",3,"click"],[1,"album-card","card","h-100"],[1,"card-body"],[1,"card-title","text-truncate","mb-3"],[1,"album-preview","d-flex"],[1,"preview-box","bg-primary"],[1,"preview-box","bg-danger","mx-2"],[1,"preview-box","bg-info"],[1,"d-flex","justify-content-between","align-items-center","mt-2"],["tabindex","0","role","button",1,"text-muted","cursor-cell",3,"click","keydown.enter","routerLink"],[1,"bi","bi-folder-fill","me-2"],["tabindex","0","role","button",1,"bi","bi-person-fill","cursor-cell",3,"click","keydown.enter","routerLink"],[1,"d-flex","justify-content-center","mt-4"],[3,"pageChange","collectionSize","page","pageSize","maxSize","ellipses","boundaryLinks"]],template:function(e,r){e&1&&(l(0,"div",0)(1,"div",1)(2,"h4",2),b(3,"Album List"),c(),_(4,G,1,1,"app-spinner",3),l(5,"div",4)(6,"div",5)(7,"app-search",6),d("search",function(o){return r.onSearch(o)}),c()(),l(8,"div",7)(9,"app-sort",8),d("sort",function(o){return r.onSort(o)}),c()()(),_(10,ee,4,3,"ng-container",9),c()()),e&2&&(a(4),s("ngIf",r.loading),a(3),s("initialValue",r.searchTerm),a(2),s("sortOptions",r.sortOptions)("initialValue",r.getSortValue()),a(),s("ngIf",!r.loading))},dependencies:[M,E,D,Q,W,q,$,Z,U,R],styles:[".album-card[_ngcontent-%COMP%]{transition:transform .2s,box-shadow .2s;cursor:pointer}.album-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 4px 15px #0000001a}.album-preview[_ngcontent-%COMP%]   .preview-box[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:4px;opacity:.8}.card[_ngcontent-%COMP%]{border:1px solid rgba(0,0,0,.1);box-shadow:0 2px 8px #0000000d}"]})};export{Y as AlbumListComponent};
